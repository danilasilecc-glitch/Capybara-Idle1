<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>HTML-bezumie Idle Capybara</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --text:#eef2f7; --muted:#a8b3c7; --card:#1d2333; --border:#2a3247;
      --accent:#7bd389; --accent2:#7bb3ff; --accent3:#ff7bd3;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Arial,sans-serif; color:var(--text);
      background:
        radial-gradient(1100px 500px at 10% -10%, #0f1630 0%, #0b0e1c 60%) fixed,
        radial-gradient(900px 600px at 90% 110%, rgba(123,179,255,.12), rgba(0,0,0,0)) fixed;
      overflow-x:hidden;
    }
    .wrap{position:relative; z-index:1; max-width:980px; margin:0 auto; padding:20px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px}
    h1{margin:0; font-size:24px; font-weight:900; letter-spacing:.2px}
    .badge{background:var(--accent); color:#0b121f; padding:6px 10px; border-radius:10px; font-weight:800; font-size:12px}
    .grid2{display:grid; grid-template-columns:1fr; gap:16px}
    @media(min-width:860px){ .grid2{grid-template-columns: 1.2fr .8fr} }
    .card{background:linear-gradient(180deg, #13182a 0%, #171d30 100%);
      border:1px solid var(--border); border-radius:16px; padding:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);}
    .btn{background:var(--accent); color:#0b121f; border:none; border-radius:14px; padding:14px 18px; font-weight:900;
      font-size:18px; cursor:pointer; box-shadow:0 4px 0 #58b873;}
    .btn.secondary{background:#27314c; color:var(--text); border:1px solid var(--border); box-shadow:none}
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .chip{background:#141a2b; border:1px solid var(--border); padding:10px 12px; border-radius:12px; font-weight:800}
    .big{font-size:20px}
    .muted{color:var(--muted)}
    .input{background:#111730; border:1px solid var(--border); color:var(--text);
      border-radius:12px; padding:12px 14px; font-size:18px; min-width:120px;}
    .tap{display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, #202743 0%, #151a30 100%);
      border:1px solid var(--border); border-radius:16px; min-height:240px; position:relative; overflow:hidden;}
    .capy{font-size:76px; filter:drop-shadow(0 6px 14px rgba(0,0,0,.4)); transition: transform .06s ease;}
    .tap:active .capy{ transform:scale(0.96) }
    .pulse{position:absolute; width:140px; height:140px; border-radius:50%;
      background:radial-gradient(closest-side, rgba(123,179,255,.45), rgba(123,179,255,0));
      animation: pulse 0.8s ease-out;}
    @keyframes pulse{from{transform:scale(.3); opacity:.8} to{transform:scale(1.2); opacity:0}}
    .shop-item{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px;
      border-radius:12px; border:1px solid var(--border); background:#12172a;}
    .shop-item + .shop-item{margin-top:10px}
    footer{margin-top:14px; font-size:12px; color:var(--muted); text-align:center}
    /* –ú–æ–¥–∞–ª–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
    #achievementsModal{display:none; position:fixed; top:10%; left:10%; width:80%; height:80%;
      background:#1d2333; border:2px solid var(--border); border-radius:16px;
      padding:20px; z-index:1000; overflow-y:auto; color:var(--text);}
    #achievementToast{display:none; position:fixed; top:0; left:50%; transform:translateX(-50%);
      background:var(--accent2); color:#0b121f; padding:12px 20px;
      border-radius:0 0 12px 12px; font-weight:800; z-index:2000;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="row">
        <h1>HTML-bezumie Idle Capybara</h1>
        <span class="badge">v2</span>
      </div>
      <div class="row">
        <button id="achievementsBtn" class="btn secondary">üèÜ</button>
        <button id="resetBtn" class="btn secondary">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
      </div>
    </header>

    <div class="grid2">
      <div class="card">
        <div class="row" style="margin-bottom:10px">
          <span class="chip big">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span></span>
          <span class="chip">–î–æ—Ö–æ–¥/—Å–µ–∫: <span id="pps">0</span></span>
          <span class="chip">–ö–ª–∏–∫–∏: <span id="clicks">0</span></span>
        </div>
        <div class="tap" id="tapArea"><div class="capy" id="capy">üêπ</div></div>
        <div class="row" style="margin-top:12px"><button id="saveBtn" class="btn secondary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></div>
        <p class="muted" id="hint" style="margin-top:8px">–ñ–º–∏ –Ω–∞ –∫–∞–ø–∏–±–∞—Ä—É üêπ ‚Äî –ø–æ–ª—É—á–∞–π –æ—á–∫–∏. –ü–æ–∫—É–ø–∞–π –∞–ø–≥—Ä–µ–π–¥—ã ‚Äî –∫–∞–ø–∏–±–∞—Ä–∞ —Ñ–∞—Ä–º–∏—Ç —Å–∞–º–∞.</p>
      </div>

      <div class="card">
        <div class="row" style="margin-bottom:10px">
          <span class="chip">–ö–ª–∏–∫: +<span id="perClick">1</span></span>
          <span class="chip">–ê–≤—Ç–æ: +<span id="perSec">0</span>/—Å–µ–∫</span>
        </div>
        <div id="shop">
          <!-- –ë–∞–∑–æ–≤—ã–µ –∞–ø–≥—Ä–µ–π–¥—ã -->
          <div class="shop-item">
            <div class="meta"><div class="title">–ü–∞–ª–æ—á–∫–∞ —É–¥–∞—á–∏ ‚ú®</div><div class="desc">+1 –∫ –¥–æ—Ö–æ–¥—É –∑–∞ –∫–ª–∏–∫.</div></div>
            <div class="act"><span class="price" id="priceClick">–¶–µ–Ω–∞: 10</span><button class="btn" id="buyClick">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ú–∞–ª–µ–Ω—å–∫–∞—è —Ñ–µ—Ä–º–∞ üåø</div><div class="desc">+1 –æ—á–∫–æ/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto1">–¶–µ–Ω–∞: 25</span><button class="btn" id="buyAuto1">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ë–æ–ª—å—à–∞—è —Ñ–µ—Ä–º–∞ üè°</div><div class="desc">+10 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto2">–¶–µ–Ω–∞: 400</span><button class="btn" id="buyAuto2">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ö–∞–ø–∏–±–∞—Ä–∞‚Äë–ø–∞—Ç–∏ üéâ</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult">–¶–µ–Ω–∞: 1000</span><button class="btn" id="buyMult">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ-–∞–ø–≥—Ä–µ–π–¥—ã -->
          <div class="shop-item">
            <div class="meta"><div class="title">–°—Ä–µ–¥–Ω—è—è —Ñ–µ—Ä–º–∞ üåæ</div><div class="desc">+50 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto3">–¶–µ–Ω–∞: 2‚ÄØ500</span><button class="btn" id="buyAuto3">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–†–∞–Ω—á–æ üêÆ</div><div class="desc">+250 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto4">–¶–µ–Ω–∞: 15‚ÄØ000</span><button class="btn" id="buyAuto4">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ó–∞–≤–æ–¥ ‚öôÔ∏è</div><div class="desc">+1‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto5">–¶–µ–Ω–∞: 100‚ÄØ000</span><button class="btn" id="buyAuto5">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ì–æ—Ä–æ–¥ üåÜ</div><div class="desc">+5‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto6">–¶–µ–Ω–∞: 600‚ÄØ000</span><button class="btn" id="buyAuto6">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ú–µ–≥–∞–ø–æ–ª–∏—Å üèôÔ∏è</div><div class="desc">+25‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto7">–¶–µ–Ω–∞: 3‚ÄØ000‚ÄØ000</span><button class="btn" id="buyAuto7">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ò–º–ø–µ—Ä–∏—è üëë</div><div class="desc">+100‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto8">–¶–µ–Ω–∞: 15‚ÄØ000‚ÄØ000</span><button class="btn" id="buyAuto8">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ñ–µ—Ä–º–∞ üöÄ</div><div class="desc">+500‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto9">–¶–µ–Ω–∞: 80‚ÄØ000‚ÄØ000</span><button class="btn" id="buyAuto9">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ú–µ–∂–º–µ—Ä–Ω–∞—è —Ñ–µ—Ä–º–∞ üåÄ</div><div class="desc">+2‚ÄØ500‚ÄØ000 –æ—á–∫–æ–≤/—Å–µ–∫.</div></div>
            <div class="act"><span class="price" id="priceAuto10">–¶–µ–Ω–∞: 400‚ÄØ000‚ÄØ000</span><button class="btn" id="buyAuto10">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ -->
          <div class="shop-item">
            <div class="meta"><div class="title">–ö–∞–ø–∏–±–∞—Ä–∞‚Äë—Ñ–µ—Å—Ç–∏–≤–∞–ª—å üé™</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult2">–¶–µ–Ω–∞: 5‚ÄØ000</span><button class="btn" id="buyMult2">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ó–æ–ª–æ—Ç–∞—è –∫–∞–ø–∏–±–∞—Ä–∞ ü™ô</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult3">–¶–µ–Ω–∞: 50‚ÄØ000</span><button class="btn" id="buyMult3">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ü–∞—Ä–∞–¥ –∫–∞–ø–∏–±–∞—Ä ü•Å</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult4">–¶–µ–Ω–∞: 500‚ÄØ000</span><button class="btn" id="buyMult4">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–û—Ä–¥–µ–Ω –∫–∞–ø–∏–±–∞—Ä üõ°Ô∏è</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult5">–¶–µ–Ω–∞: 5‚ÄØ000‚ÄØ000</span><button class="btn" id="buyMult5">–ö—É–ø–∏—Ç—å</button></div>
          </div>

          <div class="shop-item">
            <div class="meta"><div class="title">–ú–∏—Ñ–∏—á–µ—Å–∫–∞—è –∫–∞–ø–∏–±–∞—Ä–∞ ‚ú®</div><div class="desc">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞ √ó1.1.</div></div>
            <div class="act"><span class="price" id="priceMult6">–¶–µ–Ω–∞: 50‚ÄØ000‚ÄØ000</span><button class="btn" id="buyMult6">–ö—É–ø–∏—Ç—å</button></div>
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <label class="muted">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ</label>
          <input id="autosaveSec" class="input" type="number" min="5" step="5" value="15" />
          <span class="muted">—Å–µ–∫</span>
        </div>
      </div>
    </div>

    <footer>–ù–µ–æ–Ω–æ–≤—ã–π —Ñ–æ–Ω —Å –ø–∞—Ä—Ç–∏–∫–ª–∞–º–∏, —á–∏—Å—Ç—ã–π HTML/CSS/JS, –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.</footer>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
  <div id="achievementsModal">
    <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
    <ul id="achievementsList"></ul>
    <button class="btn secondary" onclick="closeAchievements()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
  <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
  <div id="achievementToast"></div>

  <script>
    const state = {
      balance: 0,
      perClickBase: 1,
      perSecBase: 0,
      clickUpgrades: 0,
      auto1: 0,
      auto2: 0,
      // –ù–æ–≤—ã–µ –∞–≤—Ç–æ-–∞–ø–≥—Ä–µ–π–¥—ã:
      auto3: 0,
      auto4: 0,
      auto5: 0,
      auto6: 0,
      auto7: 0,
      auto8: 0,
      auto9: 0,
      auto10: 0,
      // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ ‚Äî –æ–±—â–∏–π —Å—á—ë—Ç
      multCount: 0,
      clicks: 0,
      autosaveSec: 15
    };

    const el = {
      balance: document.getElementById('balance'),
      pps: document.getElementById('pps'),
      clicks: document.getElementById('clicks'),
      perClick: document.getElementById('perClick'),
      perSec: document.getElementById('perSec'),
      priceClick: document.getElementById('priceClick'),
      priceAuto1: document.getElementById('priceAuto1'),
      priceAuto2: document.getElementById('priceAuto2'),
      priceAuto3: document.getElementById('priceAuto3'),
      priceAuto4: document.getElementById('priceAuto4'),
      priceAuto5: document.getElementById('priceAuto5'),
      priceAuto6: document.getElementById('priceAuto6'),
      priceAuto7: document.getElementById('priceAuto7'),
      priceAuto8: document.getElementById('priceAuto8'),
      priceAuto9: document.getElementById('priceAuto9'),
      priceAuto10: document.getElementById('priceAuto10'),
      priceMult: document.getElementById('priceMult'),
      priceMult2: document.getElementById('priceMult2'),
      priceMult3: document.getElementById('priceMult3'),
      priceMult4: document.getElementById('priceMult4'),
      priceMult5: document.getElementById('priceMult5'),
      priceMult6: document.getElementById('priceMult6'),
      tapArea: document.getElementById('tapArea'),
      resetBtn: document.getElementById('resetBtn'),
      saveBtn: document.getElementById('saveBtn'),
      autosaveSec: document.getElementById('autosaveSec'),
    };

    function getPrices(){
      return {
        // –ö–ª–∏–∫
        click: Math.floor(10 * Math.pow(1.25, state.clickUpgrades)),
        // –ê–≤—Ç–æ-–∞–ø–≥—Ä–µ–π–¥—ã
        auto1: Math.floor(25 * Math.pow(1.22, state.auto1)),
        auto2: Math.floor(400 * Math.pow(1.18, state.auto2)),
        auto3: Math.floor(2500 * Math.pow(1.16, state.auto3)),
        auto4: Math.floor(15000 * Math.pow(1.16, state.auto4)),
        auto5: Math.floor(100000 * Math.pow(1.14, state.auto5)),
        auto6: Math.floor(600000 * Math.pow(1.14, state.auto6)),
        auto7: Math.floor(3000000 * Math.pow(1.12, state.auto7)),
        auto8: Math.floor(15000000 * Math.pow(1.12, state.auto8)),
        auto9: Math.floor(80000000 * Math.pow(1.10, state.auto9)),
        auto10: Math.floor(400000000 * Math.pow(1.10, state.auto10)),
        // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏: –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–π —Å—á–µ—Ç—á–∏–∫ multCount
        mult: Math.floor(1000 * Math.pow(1.35, state.multCount)),
        mult2: Math.floor(5000 * Math.pow(1.35, state.multCount)),
        mult3: Math.floor(50000 * Math.pow(1.35, state.multCount)),
        mult4: Math.floor(500000 * Math.pow(1.35, state.multCount)),
        mult5: Math.floor(5000000 * Math.pow(1.35, state.multCount)),
        mult6: Math.floor(50000000 * Math.pow(1.35, state.multCount)),
      };
    }

    function getMultiplier(){ return Math.pow(1.1, state.multCount); }

    function incomePerClick(){
      return Math.floor((state.perClickBase + state.clickUpgrades) * getMultiplier());
    }

    function incomePerSec(){
      const autoGain =
        state.auto1 * 1 +
        state.auto2 * 10 +
        state.auto3 * 50 +
        state.auto4 * 250 +
        state.auto5 * 1000 +
        state.auto6 * 5000 +
        state.auto7 * 25000 +
        state.auto8 * 100000 +
        state.auto9 * 500000 +
        state.auto10 * 2500000;
      return Math.floor((state.perSecBase + autoGain) * getMultiplier());
    }

    function render(){
      el.balance.textContent = state.balance.toLocaleString('ru-RU');
      el.clicks.textContent = state.clicks;
      el.perClick.textContent = incomePerClick();
      el.perSec.textContent = incomePerSec();
      el.pps.textContent = incomePerSec();

      const p = getPrices();
      el.priceClick.textContent  = '–¶–µ–Ω–∞: ' + p.click.toLocaleString('ru-RU');
      el.priceAuto1.textContent  = '–¶–µ–Ω–∞: ' + p.auto1.toLocaleString('ru-RU');
      el.priceAuto2.textContent  = '–¶–µ–Ω–∞: ' + p.auto2.toLocaleString('ru-RU');
      el.priceAuto3.textContent  = '–¶–µ–Ω–∞: ' + p.auto3.toLocaleString('ru-RU');
      el.priceAuto4.textContent  = '–¶–µ–Ω–∞: ' + p.auto4.toLocaleString('ru-RU');
      el.priceAuto5.textContent  = '–¶–µ–Ω–∞: ' + p.auto5.toLocaleString('ru-RU');
      el.priceAuto6.textContent  = '–¶–µ–Ω–∞: ' + p.auto6.toLocaleString('ru-RU');
      el.priceAuto7.textContent  = '–¶–µ–Ω–∞: ' + p.auto7.toLocaleString('ru-RU');
      el.priceAuto8.textContent  = '–¶–µ–Ω–∞: ' + p.auto8.toLocaleString('ru-RU');
      el.priceAuto9.textContent  = '–¶–µ–Ω–∞: ' + p.auto9.toLocaleString('ru-RU');
      el.priceAuto10.textContent = '–¶–µ–Ω–∞: ' + p.auto10.toLocaleString('ru-RU');

      el.priceMult.textContent  = '–¶–µ–Ω–∞: ' + p.mult.toLocaleString('ru-RU');
      el.priceMult2.textContent = '–¶–µ–Ω–∞: ' + p.mult2.toLocaleString('ru-RU');
      el.priceMult3.textContent = '–¶–µ–Ω–∞: ' + p.mult3.toLocaleString('ru-RU');
      el.priceMult4.textContent = '–¶–µ–Ω–∞: ' + p.mult4.toLocaleString('ru-RU');
      el.priceMult5.textContent = '–¶–µ–Ω–∞: ' + p.mult5.toLocaleString('ru-RU');
      el.priceMult6.textContent = '–¶–µ–Ω–∞: ' + p.mult6.toLocaleString('ru-RU');

      el.autosaveSec.value = state.autosaveSec;

      checkAchievements();
    }

    const KEY = 'capy_idle_save_v2';
    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }
    function load(){
      const raw = localStorage.getItem(KEY);
      if(!raw) return;
      try{ Object.assign(state, JSON.parse(raw)); }catch(e){}
    }
    function reset(){
      localStorage.removeItem(KEY);
      Object.assign(state,{
        balance:0, perClickBase:1, perSecBase:0, clickUpgrades:0,
        auto1:0, auto2:0, auto3:0, auto4:0, auto5:0, auto6:0, auto7:0, auto8:0, auto9:0, auto10:0,
        multCount:0, clicks:0, autosaveSec:15
      });
      render();
    }

    function tap(x,y){
      const gain = incomePerClick();
      state.balance += gain;
      state.clicks++;
      spawnPulse(x,y);
      render();
    }
    function spawnPulse(x,y){
      const p = document.createElement('div');
      p.className = 'pulse';
      p.style.left = (x - 70) + 'px';
      p.style.top  = (y - 70) + 'px';
      el.tapArea.appendChild(p);
      setTimeout(()=>p.remove(), 800);
    }

    let autoTimer = null;
    function startAuto(){
      if(autoTimer) clearInterval(autoTimer);
      autoTimer = setInterval(()=>{
        state.balance += incomePerSec();
        render();
      }, 1000);
    }

    let autosaveTimer = null;
    function startAutosave(){
      if(autosaveTimer) clearInterval(autosaveTimer);
      autosaveTimer = setInterval(save, Math.max(5, state.autosaveSec) * 1000);
    }

    function tryBuy(type){
      const prices = getPrices();
      const price = prices[type];
      if(state.balance < price) return;
      state.balance -= price;

      if(type === 'click') state.clickUpgrades++;

      // –ê–≤—Ç–æ-–∞–ø–≥—Ä–µ–π–¥—ã
      if(type === 'auto1') state.auto1++;
      if(type === 'auto2') state.auto2++;
      if(type === 'auto3') state.auto3++;
      if(type === 'auto4') state.auto4++;
      if(type === 'auto5') state.auto5++;
      if(type === 'auto6') state.auto6++;
      if(type === 'auto7') state.auto7++;
      if(type === 'auto8') state.auto8++;
      if(type === 'auto9') state.auto9++;
      if(type === 'auto10') state.auto10++;

      // –õ—é–±–∞—è –ø–æ–∫—É–ø–∫–∞ –º–Ω–æ–∂–∏—Ç–µ–ª—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—â–∏–π multCount
      if(type === 'mult'  || type === 'mult2' || type === 'mult3' ||
         type === 'mult4' || type === 'mult5' || type === 'mult6') {
        state.multCount++;
      }

      render(); save();
    }

    // –ò–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏
    el.tapArea.addEventListener('click', (e)=>{
      const rect = el.tapArea.getBoundingClientRect();
      tap(e.clientX - rect.left, e.clientY - rect.top);
    });
    el.tapArea.addEventListener('touchstart', (e)=>{
      const t = e.touches[0];
      const rect = el.tapArea.getBoundingClientRect();
      tap(t.clientX - rect.left, t.clientY - rect.top);
      e.preventDefault();
    }, {passive:false});

    document.getElementById('buyClick').addEventListener('click', ()=>tryBuy('click'));

    // –ê–≤—Ç–æ-–∞–ø–≥—Ä–µ–π–¥—ã
    document.getElementById('buyAuto1').addEventListener('click', ()=>tryBuy('auto1'));
    document.getElementById('buyAuto2').addEventListener('click', ()=>tryBuy('auto2'));
    document.getElementById('buyAuto3').addEventListener('click', ()=>tryBuy('auto3'));
    document.getElementById('buyAuto4').addEventListener('click', ()=>tryBuy('auto4'));
    document.getElementById('buyAuto5').addEventListener('click', ()=>tryBuy('auto5'));
    document.getElementById('buyAuto6').addEventListener('click', ()=>tryBuy('auto6'));
    document.getElementById('buyAuto7').addEventListener('click', ()=>tryBuy('auto7'));
    document.getElementById('buyAuto8').addEventListener('click', ()=>tryBuy('auto8'));
    document.getElementById('buyAuto9').addEventListener('click', ()=>tryBuy('auto9'));
    document.getElementById('buyAuto10').addEventListener('click', ()=>tryBuy('auto10'));

    // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏
    document.getElementById('buyMult').addEventListener('click', ()=>tryBuy('mult'));
    document.getElementById('buyMult2').addEventListener('click', ()=>tryBuy('mult2'));
    document.getElementById('buyMult3').addEventListener('click', ()=>tryBuy('mult3'));
    document.getElementById('buyMult4').addEventListener('click', ()=>tryBuy('mult4'));
    document.getElementById('buyMult5').addEventListener('click', ()=>tryBuy('mult5'));
    document.getElementById('buyMult6').addEventListener('click', ()=>tryBuy('mult6'));

    el.saveBtn.addEventListener('click', ()=>{ save(); render(); });
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')){ reset(); save(); }
    });
    el.autosaveSec.addEventListener('change', ()=>{
      const v = parseInt(el.autosaveSec.value||'15',10);
      state.autosaveSec = Math.max(5, v);
      startAutosave(); save(); render();
    });

    // --- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è ---
    const achievements = [
      {id:'click1000', name:'–ö–ª–∏–∫‚Äë–º–∞—Å—Ç–µ—Ä', desc:'–°–¥–µ–ª–∞—Ç—å 1000 –∫–ª–∏–∫–æ–≤', check:()=>state.clicks>=1000},
      {id:'balance10000', name:'–§–µ—Ä–º–µ—Ä –∫–∞–ø–∏–±–∞—Ä', desc:'–î–æ—Å—Ç–∏—á—å –±–∞–ª–∞–Ω—Å–∞ 10 000', check:()=>state.balance>=10000},
      {id:'auto10', name:'–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', desc:'–ö—É–ø–∏—Ç—å 10 –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ñ–µ—Ä–º', check:()=>state.auto1>=10},
    ];
    let unlocked = JSON.parse(localStorage.getItem('capy_achievements')||'[]');

    function showToast(text){
      const toast = document.getElementById('achievementToast');
      toast.textContent = text;
      toast.style.display='block';
      setTimeout(()=>toast.style.display='none', 4000);
    }

    function checkAchievements(){
      achievements.forEach(a=>{
        if(!unlocked.includes(a.id) && a.check()){
          unlocked.push(a.id);
          localStorage.setItem('capy_achievements', JSON.stringify(unlocked));
          showToast(`–í—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "${a.name}"`);
        }
      });
    }

    function openAchievements(){
      const modal = document.getElementById('achievementsModal');
      const list = document.getElementById('achievementsList');
      list.innerHTML='';
      achievements.forEach(a=>{
        const li = document.createElement('li');
        const done = unlocked.includes(a.id);
        li.textContent = `${a.name} ‚Äî ${a.desc} ${done?'‚úÖ':'‚ùå'}`;
        list.appendChild(li);
      });
      modal.style.display='block';
    }
    function closeAchievements(){
      document.getElementById('achievementsModal').style.display='none';
    }
    document.getElementById('achievementsBtn').addEventListener('click', openAchievements);

    // --- –ó–∞–ø—É—Å–∫ ---
    load();
    render();
    startAuto();
    startAutosave();
  </script>
</body>
</html>